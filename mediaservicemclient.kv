#:kivy 1.10.0
#:import hex kivy.utils.get_color_from_hex
#:import Factory kivy.factory.Factory
<DownloadButton@Button>:
    size_hint_x: None
    size_hint_y: None
    width: dp(50)
    height: dp(50)
    pos_hint:{'center_x': 0.5, 'center_y': 0.5}
    background_down: "./images/downl.png"
    background_normal: "./images/downl.png"
    color: 0,0,0,0

<PlayButton@Button>:
    size_hint_x: None
    size_hint_y: None
    width: dp(50)
    height: dp(50)
    pos_hint:{'center_x': 0.5, 'center_y': 0.5}
    background_down: "./images/play.png"
    background_normal: "./images/play.png"
    color: 0,0,0,0


<ProgressBarLabel@Label>
    size_hint_y: None
    height: dp(400)
    size_hint_x: None
    width: dp(400)
    pos_hint:{'center_x': 0.5, 'center_y': 0.5}

<SettingsViewItem>:
    id: settings_view_i
    orientation: 'horizontal'
    size_hint_y: .4

    Label:
        id: settings_view_i_name
        size_hint_x: .7
        font_size: dp(17)
        color: hex('#ffa500')
        text: ''
        font_hinting: 'mono'
#        italic: True
    CheckBox:
        id: settings_view_i_check
        size_hint_x: .3
        group: 'settings_address_setter'
        background_radio_down: "./images/chprd.png"
        background_radio_normal: "./images/chpr.png"
        on_press: root.return_on_active_name(self.active, settings_view_i_name.text)


<SettingsViewButton@Button>

    size_hint_x: None
    size_hint_y: None
    width: dp(200)
    height: dp(70)
    pos_hint:{'center_x': 0.5, 'center_y': 0.5}
    background_down: "./images/b_b.png"
    background_normal: "./images/b_a.png"

<SettingsView>:
    name: 'settings'
    orientation: 'vertical'
    id: settings_view

    BoxLayout:
        orientation: 'vertical'
        id: settings_view_container
        opacity: 1
        canvas.before:
            Color:
                rgba: hex('#202020')
            Rectangle:
                pos: self.pos
                size: self.size
        BoxLayout:
            orientation: 'horizontal'
            id: settings_view_container_back_button_container
            opacity: 1
            size_hint_y: 0.2
            BoxLayout:
                size_hint_x: 0.33
                FloatLayout:

                    SettingsViewButton:
                        width: dp(30)
                        height: dp(30)
                        pos_hint:{'center_x': 0.3, 'center_y': 0.5}

                        background_down: "./images/back_icon.png"
                        background_normal: "./images/back_icon.png"
                        on_release: root.return_to_main_view()

            BoxLayout:
                size_hint_x: 0.33
                RelativeLayout:
                    Image:
                        source: './images/scan.png'
                        size_hint_x: None
                        size_hint_y: None
                        width: dp(150)
                        height: dp(150)
                        pos_hint:{'center_x': 0.5, 'center_y': 0.3}

            BoxLayout:
                size_hint_x: 0.33


        BoxLayout:
            orientation: 'vertical'
            id: settings_view_container_list_container
            opacity: 1
            size_hint_y: 0.6
            GridLayout:
                id: set_scanned_devices_list_grid
                cols:1
                rows: 6
                size_hint_y: 1
                padding: 45,45,45,45
                spacing: 45,45

        BoxLayout:
            orientation: 'horizontal'
            id: settings_view_container_scan_again
            opacity: 1
            size_hint_y: 0.2
            BoxLayout:
                FloatLayout:
                    SettingsViewButton:
                        text: 'Scan Again'
                        on_release: root.scan_again()

            BoxLayout:
                id: settings_view_save_button_container

                FloatLayout:
                    SettingsViewButton:
                        id: settings_save_chosen_device_and_go_to_main
                        text: 'Save'
                        size_hint_x: None
                        size_hint_y: None
                        width: dp(200)
                        height: dp(70)
                        pos_hint:{'center_x': 0.5, 'center_y': 0.5}
                        background_down: "./images/b_b.png"
                        background_normal: "./images/b_a.png"
                        on_release: root.save_settings()

<ScanView>:
    name: 'scan'
    orientation: 'vertical'
    id: scan_view
    save_button: save_chosen_device_and_go_to_main.disabled

    BoxLayout:
        orientation: 'vertical'
        id: scan_view_container
        opacity: 1
        canvas.before:
            Color:
                rgba: hex('#202020')
            Rectangle:
                pos: self.pos
                size: self.size
        BoxLayout:
            size_hint_y: .2
            RelativeLayout:
                Image:
                    source: './images/scan.png'
                    size_hint_x: None
                    size_hint_y: None
                    width: dp(150)
                    height: dp(150)
                    pos_hint:{'center_x': 0.5, 'center_y': 0.3}

        BoxLayout:
            id: scanned_devices_list
            size_hint_y: .6
            GridLayout:
                id: scanned_devices_list_grid
                cols:1
                rows: 3
                size_hint_y: 1
                padding: 45,45,45,45
                spacing: 45,45



        BoxLayout:
            id: scan_view_button_container
            size_hint_y: .2
            orientation: 'horizontal'
            FloatLayout:

                Button:
                    id: save_chosen_device_and_go_to_main
                    text: 'Save'
                    size_hint_x: None
                    size_hint_y: None
                    width: dp(200)
                    height: dp(70)
                    pos_hint:{'center_x': 0.5, 'center_y': 0.5}
                    background_down: "./images/b_b.png"
                    background_normal: "./images/b_a.png"
                    on_release: root.save_and_go_to_main()

<MainViewButton@Button>:
    size_hint_x: None
    size_hint_y: None
    width: dp(40)
    height: dp(40)


<MainView>:
    name: 'main'
    orientation: 'vertical'
    connection_status_indicator: status_flagger.active
    on_enter: root.connect_on_enter()
    BoxLayout:
        id: main_view_c
        orientation: 'vertical'
        BoxLayout:
            orientation: 'vertical'
            id: main_view_container
            opacity: 1
            BoxLayout:
                size_hint_y: .05
                id: navigation_a
                orientation: 'horizontal'
                canvas.before:
                    Color:
                        rgba: hex('#000000')
                    Rectangle:
                        pos: self.pos
                        size: self.size
                BoxLayout:
                    id: settings_button
                    size_hint_x: .18
                    RelativeLayout:
                        MainViewButton:
                            text: ''
                            background_down: "./images/settings_icon.png"
                            background_normal: "./images/settings_icon.png"
                            on_release: root.navigate_to_settings()
                            pos_hint: {'center_x': 0.5, 'center_y': 0.5}

                BoxLayout:
                    id: search
                    size_hint_x: .18
                    RelativeLayout:
                        MainViewButton:
                            text: ''
                            background_down: "./images/search_icon.png"
                            background_normal: "./images/search_icon.png"
                            on_release: root.set_as_current_screen_search('search_view', mov_b, lat_b, ser_b, search_input_in.text, search_input_in)
                            pos_hint: {'center_x': 0.5, 'center_y': 0.5}


                BoxLayout:
                    id: search_input
                    size_hint_x: .38
                    TextInput:
                        id: search_input_in
                        text: ''
                        background_down: "./images/n_b.png"
                        background_normal: "./images/n_b.png"
                        background_active: "./images/n_b.png"
                        cursor_color: hex('#ffa500')
                        foreground_color: hex('#ffa500')
                        on_focus: root.searchInput_on_focus_effect(self,self.focus)
                        multiline: False
                        padding: 15,0,15,0
                        font_size: dp(25)

                BoxLayout:
                    id: filter_modal
                    size_hint_x: .18
                    RelativeLayout:
                        MainViewButton:
                            text: ''
                            background_down: "./images/filter_icon.png"
                            background_normal: "./images/filter_icon.png"
                            on_release: root.open_filter_view()
                            pos_hint: {'center_x': 0.5, 'center_y': 0.5}


                BoxLayout:
                    id: connection_status_ind
                    size_hint_x: .18
                    orientation: 'vertical'
                    Switch:
                        id: status_flagger
                        opacity: 0
                        size_hint_y:0
                        active: False
                        on_active: root.update_status_in(self.active)
                    Image:
                        id: connection_status_ind_l
                        source: 'images/on_connection.png'

            BoxLayout:
                id: navigation_b
                orientation: 'horizontal'
                size_hint_y: .06

                Button:
                    text: 'movies'
                    id: mov_b
                    background_down: "./images/n_b.png"
                    background_normal: "./images/n_n.png"
                    on_release: root.set_as_current_screen(self, 'movies_view', ser_b, lat_b)
                Button:
                    text: 'series'
                    id: ser_b
                    background_down: "./images/n_b.png"
                    background_normal: "./images/n_n.png"
                    on_release: root.set_as_current_screen(self,'series_view', mov_b, lat_b)
                Button:
                    text: 'latest'
                    id: lat_b
                    background_down: "./images/n_b.png"
                    background_normal: "./images/n_n.png"
                    on_release: root.set_as_current_screen(self,'latest_view', mov_b, ser_b)

            BoxLayout:
                id: screen_m_container
                size_hint_y: .89
                canvas.before:
                    Color:
                        rgba: hex('#ffa500')
                    Rectangle:
                        pos: self.pos
                        size: self.size

<Progression>:
    orientation: 'vertical'
    id: progression_view

    BoxLayout:
        orientation: 'vertical'
        id: progress_bar_container
        opacity: 1
        FloatLayout:
            ProgressBarLabel:
                id: progress_bar_main_image
                opacity: 0.0
                canvas.before:
                    Rectangle:
                        pos: self.pos
                        size: self.size
                        source: 'images/load_seco.png'
            ProgressBarLabel:
                id: progress_bar_overlay_image
                opacity: 1
                canvas.before:
                    Rectangle:
                        pos: self.pos
                        size: self.size
                        source: 'images/load_mai.png'
            ProgressBarLabel:
                id: progress_bar_overlay_image_t
                opacity: 1
                size_hint_x: None
                width: dp(400)
                height: dp(50)
                pos_hint:{'center_x': 0.5, 'center_y': 0.39}
                canvas.before:
                    Color:
                        rgba: hex('#000000')
                    Rectangle:
                        pos: self.pos
                        size: self.size


<SearchView>:
    name: 'search_view'

    BoxLayout:
        orientation: 'vertical'
        id: search_view_container
        opacity: 1
        canvas.before:
            Color:
                rgba: hex('#8b4513')
            Rectangle:
                pos: self.pos
                size: self.size
        Label:
            text: root.name

<ShowEpTor>:
    orientation: 'vertical'
    size_hint_y: None
    height: dp(120)

<ShowEpSingleTor>:
    orientation: 'vertical'
    Label:
        id: tor_quality_label
        size_hint_y: .2
        text:
        canvas.before:
            Color:
                rgba: hex('#202020')
            Rectangle:
                pos: self.pos
                size: self.size
    BoxLayout:
        orientation: 'horizontal'
        size_hint_y: .8
        BoxLayout:
            RelativeLayout:
                PlayButton:
                    id: tor_play
                    on_release: root.play_torrent()
        BoxLayout:
            RelativeLayout:
                DownloadButton:
                    id: tor_down
                    on_release: root.download_torrent()

<ShowEpSyn>:
    size_hint_y: None
    height: dp(120)
    readonly: True
    multiline: True
    color: 0,0,0,0
    cursor_color: 0,0,0,0
    padding: 20,20,20,20
    foreground_color: hex('#ffa500')
    background_color: (0,0,0,0)

<SeriesViewMainSingleTop>:
    orientation: 'horizontal'
    BoxLayout:
        orientation: 'horizontal'
        id: series_view_main_single_top_im_holder
        size_hint_x:.3
        AsyncImage:
            id: series_view_main_single_top_im_holder_IM
            source: ''


    BoxLayout:
        orientation: 'vertical'
        id: series_view_main_single_top_other
        size_hint_x:.7
        BoxLayout:
            size_hint_y: .1
            orientation: 'horizontal'
            Label:
                id: series_view_main_single_top_other_YE
                color: hex('#ffa500')
                text:
            Label:
                id: series_view_main_single_top_other_RU
                color: hex('#ffa500')
                text:
        Label:
            size_hint_y: .1
            id: series_view_main_single_top_other_ST
            color: hex('#ffa500')
            text:
        BoxLayout:
            size_hint_y: .8
            ScrollView:
                id: scrlv
                TextInput:
                    size_hint_y: None
                    id: series_view_main_single_top_other_DE
                    readonly: True
                    multiline: True
                    color: 0,0,0,0
                    cursor_color: 0,0,0,0
                    padding: 20,20,20,20
                    foreground_color: hex('#ffa500')
                    background_color: (0,0,0,0)
                    height: max(self.minimum_height, scrlv.height)


<SeriesViewMainSingle>:
    BoxLayout:
        id: svmsingle
        orientation: 'vertical'
        canvas.before:
            Color:
                rgba: hex('#000000')
            Rectangle:
                pos: self.pos
                size: self.size
        BoxLayout:
            orientation: 'horizontal'
            id: series_view_main_single_nav
            size_hint_y:.05
            canvas.before:
                Color:
                    rgba: hex('#202020')
                Rectangle:
                    pos: self.pos
                    size: self.size
            BoxLayout:
                size_hint_x: .2

                FloatLayout:

                    SettingsViewButton:
                        width: dp(25)
                        height: dp(25)
                        background_down: "./images/back_icon.png"
                        background_normal: "./images/back_icon.png"
                        on_press : root.go_back_to_series()
            BoxLayout:
                id: series_view_main_single_nav_title
                size_hint_x: .6
                Label:
                    id: series_view_main_single_nav_title_t
                    text: ''
            BoxLayout:
                size_hint_x: .2
        BoxLayout:
            orientation: 'vertical'
            size_hint_y: .45
            id: series_view_main_single_container
            canvas.before:
                Color:
                    rgba: hex('#000000')
                Rectangle:
                    pos: self.pos
                    size: self.size
        BoxLayout:
            orientation: 'vertical'
            size_hint_y: .5
            id: series_view_main_single_container_se
            canvas.before:
                Color:
                    rgba: hex('#000000')
                Rectangle:
                    pos: self.pos
                    size: self.size



<SeriesViewMain>:
    BoxLayout:
        orientation: 'vertical'
        id: series_view_main_container
        opacity: 1
        canvas.before:
            Color:
                rgba: hex('#ffa500')
            Rectangle:
                pos: self.pos
                size: self.size

<SeriesView>:
    name: 'series_view'
    BoxLayout:
        orientation: 'vertical'
        id: series_view_container
        opacity: 1
        canvas.before:
            Color:
                rgba: hex('#ffa500')
            Rectangle:
                pos: self.pos
                size: self.size
        BoxLayout:
            id: series_pag_holder
            size_hint_y: .09
            padding: 5,0
            canvas.before:
                Color:
                    rgba: hex('#000000')
                Rectangle:
                    pos: self.pos
                    size: self.size
        BoxLayout:
            id: ser_view_holder
            size_hint_y: .91
            canvas.before:
                Color:
                    rgba: hex('#000000')
                Rectangle:
                    pos: self.pos
                    size: self.size

<MoviesEpTor>:
    orientation: 'vertical'

<MoviesEpSingleTor>:
    orientation: 'vertical'
    Label:
        id: tor_quality_label
        size_hint_y: .2
        text:
        canvas.before:
            Color:
                rgba: hex('#202020')
            Rectangle:
                pos: self.pos
                size: self.size
    BoxLayout:
        orientation: 'horizontal'
        size_hint_y: .8
        BoxLayout:
            RelativeLayout:
                PlayButton:
                    id: tor_play
                    on_release: root.play_torrent()
        BoxLayout:
            RelativeLayout:
                DownloadButton:
                    id: tor_down
                    on_release: root.download_torrent()

<MoviesViewMainSingleTop>:
    orientation: 'horizontal'
    BoxLayout:
        orientation: 'horizontal'
        id: movies_view_main_single_top_im_holder
        size_hint_x:.3
        AsyncImage:
            id: movies_view_main_single_top_im_holder_IM
            source: ''


    BoxLayout:
        orientation: 'vertical'
        id: movies_view_main_single_top_other
        size_hint_x:.7
        BoxLayout:
            size_hint_y: .2
            orientation: 'horizontal'
            Label:
                id: movies_view_main_single_top_other_YE
                color: hex('#ffa500')
                text:
            Label:
                id: movies_view_main_single_top_other_RU
                color: hex('#ffa500')
                text:

        BoxLayout:
            size_hint_y: .8
            ScrollView:
                id: scrlv
                TextInput:
                    size_hint_y: None
                    id: movies_view_main_single_top_other_DE
                    readonly: True
                    multiline: True
                    color: 0,0,0,0
                    cursor_color: 0,0,0,0
                    padding: 20,20,20,20
                    foreground_color: hex('#ffa500')
                    background_color: (0,0,0,0)
                    height: max(self.minimum_height, scrlv.height)


<MoviesViewMainSingle>:
    BoxLayout:
        id: mvmsingle
        orientation: 'vertical'
        canvas.before:
            Color:
                rgba: hex('#000000')
            Rectangle:
                pos: self.pos
                size: self.size
        BoxLayout:
            orientation: 'horizontal'
            id: movies_view_main_single_nav
            size_hint_y:.05
            canvas.before:
                Color:
                    rgba: hex('#202020')
                Rectangle:
                    pos: self.pos
                    size: self.size
            BoxLayout:
                size_hint_x: .2

                FloatLayout:

                    SettingsViewButton:
                        width: dp(25)
                        height: dp(25)
                        background_down: "./images/back_icon.png"
                        background_normal: "./images/back_icon.png"
                        on_press : root.go_back_to_movies()
            BoxLayout:
                id: movies_view_main_single_nav_title
                size_hint_x: .6
                Label:
                    id: movies_view_main_single_nav_title_t
                    text: ''
            BoxLayout:
                size_hint_x: .2
        BoxLayout:
            orientation: 'vertical'
            size_hint_y: .60
            id: movies_view_main_single_container
            canvas.before:
                Color:
                    rgba: hex('#000000')
                Rectangle:
                    pos: self.pos
                    size: self.size
        BoxLayout:
            orientation: 'vertical'
            size_hint_y: .35
            id: movies_view_main_single_container_se
            canvas.before:
                Color:
                    rgba: hex('#000000')
                Rectangle:
                    pos: self.pos
                    size: self.size

<MoviesViewMain>:
    BoxLayout:
        orientation: 'vertical'
        id: movies_view_main_container
        opacity: 1
        canvas.before:
            Color:
                rgba: hex('#ffa500')
            Rectangle:
                pos: self.pos
                size: self.size

<MoviesView>:
    name: 'movies_view'
    BoxLayout:
        orientation: 'vertical'
        id: movies_view_container
        opacity: 1
        canvas.before:
            Color:
                rgba: hex('#ffa500')
            Rectangle:
                pos: self.pos
                size: self.size

        BoxLayout:
            id: movies_pag_holder
            size_hint_y: .09
            padding: 5,0
            canvas.before:
                Color:
                    rgba: hex('#000000')
                Rectangle:
                    pos: self.pos
                    size: self.size
        BoxLayout:
            id: mov_view_holder
            size_hint_y: .91
            canvas.before:
                Color:
                    rgba: hex('#000000')
                Rectangle:
                    pos: self.pos
                    size: self.size

<LatestViewMain>:
    BoxLayout:
        orientation: 'vertical'
        id: latest_view_main_container
        opacity: 1
        canvas.before:
            Color:
                rgba: hex('#ffa500')
            Rectangle:
                pos: self.pos
                size: self.size
        BoxLayout:
            id: latest_view_main_movies_container
            size_hint_y: .49
            padding: 15,15,15,15
        BoxLayout:
            size_hint_y: 0.02
            opacity: 1
            canvas.before:
                Color:
                    rgba: hex('#000000')
                Rectangle:
                    pos: self.pos
                    size: self.size
        BoxLayout:
            id: latest_view_main_shows_container
            size_hint_y: .48
            padding: 15,15,15,15

<LatestView>:
    name: 'latest_view'
    on_enter: root.refresh_on_enter()
    BoxLayout:
        orientation: 'vertical'
        id: latest_view_container
        opacity: 1
        canvas.before:
            Color:
                rgba: hex('#e6e8fa')
            Rectangle:
                pos: self.pos
                size: self.size
        BoxLayout:
            id: lat_view_holder
            size_hint_y: 1
            canvas.before:
                Color:
                    rgba: hex('#000000')
                Rectangle:
                    pos: self.pos
                    size: self.size

<Item>:
    id: ite
    orientation: 'vertical'
    size_hint:(None, None)
    canvas.before:
        Color:
            rgba: hex('#00000')
        Rectangle:
            pos: self.pos
            size: self.size

<ScanViewItem>:
    id: scan_view_i
    orientation: 'horizontal'
    size_hint_y: .4

    Label:
        id: scan_view_i_name
        size_hint_x: .7
        font_size: dp(16)
        padding: 15,15
        color: hex('#ffa500')
        text: ''
        font_hinting: 'mono'
#        italic: True

    CheckBox:
        id: scan_view_i_check
        size_hint_x: .3
        group: 'address_setter'
#        color: hex('#ffa500')
        background_radio_down: "./images/chprd.png"
        background_radio_normal: "./images/chpr.png"
        on_press: root.return_on_active_name(self.active, scan_view_i_name.text)

<FilterSpinner@Spinner>
    size_hint_x: None
    size_hint_y: None
    width: dp(200)
    height: dp(50)
    background_down: "./images/b_b.png"
    background_normal: "./images/filter_list_i.png"
    option_cls: Factory.TemplSpinnerOption
    sync_height: True


<TemplSpinnerOption@SpinnerOption>
    background_down: "./images/b_b.png"
    background_normal: "./images/filter_list_i.png"

<FilterModalView>:
    auto_dismiss: True
    size_hint: (None, None)
    on_dismiss: root.close_filter(filter_type.text, filter_genre.text, filter_order.text, filter_sort.text)
    BoxLayout:
        id: filter_view_container
        orientation: 'vertical'
        RelativeLayout:
            FilterSpinner:
                id: filter_sort
                text: 'Sort'
                values: ['name','rating','trending','updated','year','last added', 'title']
                pos_hint: {'center_x': 0.5, 'center_y': 0.8}
                on_release: root.hide_other_accordions(self)

            FilterSpinner:
                id: filter_type
                text: 'Type'
                values: ['Shows', 'Movies']
                pos_hint: {'center_x': 0.5, 'center_y': 0.4}
                on_release: root.hide_other_accordions(self)

            FilterSpinner:
                id: filter_order
                text: 'Order'
                values: ['-1','1']
                pos_hint: {'center_x': 0.5, 'center_y': 0.6}
                on_release: root.hide_other_accordions(self)

            FilterSpinner:
                id: filter_genre
                text: 'Genre'
                values: ['action','adventure','animation','comedy','crime','documentary','drama','eastern','family','fan-film','fantasy','film-noir','history','horror','indie','mystery','none','romance','science-fiction','thriller','tv-movie','western']
                pos_hint: {'center_x': 0.5, 'center_y': 0.2}
                on_release: root.hide_other_accordions(self)


<ConnectionErrorPopup>:
    auto_dismiss: False
    size_hint: (None, None)
    separator_color: hex('#ffa500')
    title: 'Connection error'
    title_align: 'center'
    BoxLayout:
        id: con_er_m
        orientation: 'vertical'
        canvas.before:
            Color:
                rgba: hex('#000000')
            Rectangle:
                pos: self.pos
                size: self.size
        Label:
            text: 'No connection to internet'

        Button:
            text: 'Retry'
            size_hint_x: None
            size_hint_y: None
            width: dp(200)
            height: dp(70)
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
            background_down: "./images/b_b.png"
            background_normal: "./images/b_a.png"
            on_release: root.retry()

        Button:
            text: 'Quit'
            size_hint_x: None
            size_hint_y: None
            width: dp(200)
            height: dp(70)
            pos_hint:{'center_x': 0.5, 'center_y': 0.5}
            background_down: "./images/b_b.png"
            background_normal: "./images/b_a.png"
            on_release: root.quit_app_cl()

<LoaderOverlay>:
    auto_dismiss: True
    size_hint: (None, None)
    background: './images/tb.png'
    BoxLayout:
        id: lo_container
        Image:
            allow_stretch: True
            source: './images/loa_over.png'


<PaginationButton>:
    size_hint_x: None
    size_hint_y: None
    width: dp(60)
    height: dp(50)
#    background_color:hex('#ffa500')