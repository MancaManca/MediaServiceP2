#:kivy 1.10.0
#:import hex kivy.utils.get_color_from_hex
#:import Factory kivy.factory.Factory

<TextInputYellow@TextInput>
    readonly: True
    multiline: True
    color: 0,0,0,0
    cursor_color: 0,0,0,0
    padding: 20,20,20,20
    foreground_color: hex('#ffa500')
    background_color: (0,0,0,0)

<FancyCheckbox@CheckBox>
    size_hint_x: .2
    background_radio_down: "./images/chprd.png"
    background_radio_normal: "./images/chpr.png"

<ScannerGrid@GridLayout>
    cols:1
    rows: 6
    size_hint_y: 1
    padding: 45,45,45,45
    spacing: 45,45

<BlackBox@BoxLayout>:
    canvas.before:
        Color:
            rgba: hex('#000000')
        Rectangle:
            pos: self.pos
            size: self.size

<OkerBox@BoxLayout>:
    canvas.before:
        Color:
            rgba: hex('#ffa500')
        Rectangle:
            pos: self.pos
            size: self.size

<GreyLighterBox@BoxLayout>:
    canvas.before:
        Color:
            rgba: hex('#3e3e3e')
        Rectangle:
            pos: self.pos
            size: self.size

<GreyBox@BoxLayout>:
    canvas.before:
        Color:
            rgba: hex('#292929')
        Rectangle:
            pos: self.pos
            size: self.size

<GreyLabel@Label>:
    canvas.before:
        Color:
            rgba: hex('#2a2a2a')
        Rectangle:
            pos: self.pos
            size: self.size

<Scanner@Image>:
    source: './images/scan.png'
    size_hint_x: None
    size_hint_y: None
    width: dp(150)
    height: dp(150)
    pos_hint:{'center_x': 0.5, 'center_y': 0.3}

<DownloadButton@Button>:
    size_hint_x: None
    size_hint_y: None
    width: dp(50)
    height: dp(50)
    pos_hint:{'center_x': 0.5, 'center_y': 0.5}
    background_down: "./images/downl.png"
    background_normal: "./images/downl.png"
    color: 0,0,0,0

<PlayButton@Button>:
    size_hint_x: None
    size_hint_y: None
    width: dp(50)
    height: dp(50)
    pos_hint:{'center_x': 0.5, 'center_y': 0.5}
    background_down: "./images/play.png"
    background_normal: "./images/play.png"
    color: 0,0,0,0


<ProgressBarLabel@Label>
    size_hint_y: None
    height: dp(400)
    size_hint_x: None
    width: dp(400)
    pos_hint:{'center_x': 0.5, 'center_y': 0.5}


<SettingsViewItem>:
    id: settings_view_i
    orientation: 'horizontal'
    size_hint_y: .4
    Label:
        id: settings_view_i_name
        size_hint_x: .8
        font_size: dp(17)
        color: hex('#ffa500')
        text: ''
        font_hinting: 'mono'
#        italic: True
    FancyCheckbox:
        id: settings_view_i_check
        group: 'settings_address_setter'
        on_press: root.return_on_active_name(self.active, settings_view_i_name.text)


<SettingsViewButton@Button>
    size_hint_x: None
    size_hint_y: None
    width: dp(150)
    height: dp(60)
    pos_hint:{'center_x': 0.5, 'center_y': 0.5}
    background_down: "./images/b_b.png"
    background_normal: "./images/b_a.png"


<SettingsView>:
    name: 'settings'
    orientation: 'vertical'
    id: settings_view
    GreyBox:
        orientation: 'vertical'
        id: settings_view_container
        opacity: 1
        BoxLayout:
            orientation: 'horizontal'
            id: settings_view_container_back_button_container
            opacity: 1
            size_hint_y: 0.2
            BoxLayout:
                RelativeLayout:
                    Scanner:
        BoxLayout:
            orientation: 'vertical'
            id: settings_view_container_list_container
            opacity: 1
            size_hint_y: 0.6
            ScannerGrid:
                id: set_scanned_devices_list_grid
        BoxLayout:
            orientation: 'horizontal'
            id: settings_view_container_scan_again
            opacity: 1
            size_hint_y: 0.2
            BoxLayout:
                size_hint_x:.4
                FloatLayout:
                    SettingsViewButton:
                        text: 'Scan Again'
                        on_release: root.scan_again()
            BoxLayout:
                size_hint_x:.2
                FloatLayout:
                    SettingsViewButton:
                        width: dp(40)
                        height: dp(40)
                        background_down: "./images/back_icon.png"
                        background_normal: "./images/back_icon.png"
                        on_release: root.return_to_main_view()
            BoxLayout:
                size_hint_x:.4
                id: settings_view_save_button_container
                FloatLayout:
                    SettingsViewButton:
                        id: settings_save_chosen_device_and_go_to_main
                        text: 'Save'
                        on_release: root.save_settings()


<ScanView>:
    name: 'scan'
    orientation: 'vertical'
    id: scan_view
    save_button: save_chosen_device_and_go_to_main.disabled
    GreyBox:
        orientation: 'vertical'
        id: scan_view_container
        opacity: 1
        BoxLayout:
            size_hint_y: .2
            RelativeLayout:
                Scanner:
        BoxLayout:
            id: scanned_devices_list
            size_hint_y: .6
            ScannerGrid:
                id: scanned_devices_list_grid

        BoxLayout:
            id: scan_view_button_container
            size_hint_y: .2
            orientation: 'horizontal'
            FloatLayout:
                SettingsViewButton:
                    id: save_chosen_device_and_go_to_main
                    text: 'Save'
                    width: dp(200)
                    height: dp(70)
                    on_release: root.save_and_go_to_main()


<MainViewButton@Button>:
    size_hint_x: None
    size_hint_y: None
    width: dp(40)
    height: dp(40)
    pos_hint: {'center_x': 0.5, 'center_y': 0.5}


<MainViewButtonNav@Button>:
    background_down: "./images/n_b.png"
    background_normal: "./images/n_n.png"

<MainView>:
    name: 'main'
    orientation: 'vertical'
    connection_status_indicator: status_flagger
    on_enter: root.connect_on_enter()
    BoxLayout:
        id: main_view_c
        orientation: 'vertical'
        BoxLayout:
            orientation: 'vertical'
            id: main_view_container
            opacity: 1
            GreyLighterBox:
                size_hint_y: .05
                id: navigation_a
                orientation: 'horizontal'
                BoxLayout:
                    id: settings_button
                    size_hint_x: .16
                    RelativeLayout:
                        MainViewButton:
                            id: settings_button_drop
                            text: ''
                            background_down: "./images/settings_icon.png"
                            background_normal: "./images/settings_icon.png"
                            on_release: root.navigate_to_settings()
                BoxLayout:
                    id: search
                    size_hint_x: .16
                    RelativeLayout:
                        MainViewButton:
                            text: ''
                            id: search_icon_bu
                            background_down: "./images/search_icon.png"
                            background_normal: "./images/search_icon.png"
                            on_release: root.set_as_current_screen_search('search_view', search_input_in.text, search_input_in)
                BoxLayout:
                    id: search_input
                    size_hint_x: .36
                    TextInput:
                        id: search_input_in
                        text: ''
                        background_down: "./images/n_b.png"
                        background_normal: "./images/n_b.png"
                        background_active: "./images/n_b.png"
                        cursor_color: hex('#ffa500')
                        foreground_color: hex('#ffa500')
                        on_focus: root.searchInput_on_focus_effect(self, self.focus)
                        multiline: False
                        padding: 15,10,15,0
                        font_size: dp(17)
                        opacity: .2
                BoxLayout:
                    id: filter_modal
                    size_hint_x: .16
                    RelativeLayout:
                        MainViewButton:
                            text: ''
                            background_down: "./images/filter_icon.png"
                            background_normal: "./images/filter_icon.png"
                            on_release: root.open_filter_view()
                BoxLayout:
                    id: connection_status_ind
                    size_hint_x: .16
                    orientation: 'vertical'
                    RelativeLayout:
                        Switch:
                            id: status_flagger
                            opacity: 0
                            size_hint_y:0
                            active: False
                            on_active: root.update_status_in(self.active)
                        Image:
                            id: connection_status_ind_l
                            source: 'images/on_connection.png'
                            size_hint_x: None
                            size_hint_y: None
                            width: dp(40)
                            height: dp(40)
                            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
            GreyBox:
                id: navigation_b
                orientation: 'horizontal'
                size_hint_y: .06

#                MainViewButtonNav:
#                    text: 'Movies'
#                    id: mov_b
#                    on_release: root.set_as_current_screen(self, 'movies_view', ser_b, lat_b)
#                MainViewButtonNav:
#                    text: 'Series'
#                    id: ser_b
#                    on_release: root.set_as_current_screen(self,'series_view', mov_b, lat_b)
#                MainViewButtonNav:
#                    text: 'Latest'
#                    id: lat_b
#                    on_release: root.set_as_current_screen(self,'latest_view', mov_b, ser_b)
            OkerBox:
                id: screen_m_container

                size_hint_y: .89


<Progression>:
    orientation: 'vertical'
    id: progression_view
    BoxLayout:
        orientation: 'vertical'
        id: progress_bar_container
        opacity: 1
        FloatLayout:
            ProgressBarLabel:
                id: progress_bar_main_image
                opacity: 0.0
                canvas.before:
                    Rectangle:
                        pos: self.pos
                        size: self.size
                        source: 'images/load_seco.png'
            ProgressBarLabel:
                id: progress_bar_overlay_image
                opacity: 1
                canvas.before:
                    Rectangle:
                        pos: self.pos
                        size: self.size
                        source: 'images/load_mai.png'
            ProgressBarLabel:
                id: progress_bar_overlay_image_t
                opacity: 1
                size_hint_x: None
                width: dp(400)
                height: dp(50)
                pos_hint:{'center_x': 0.5, 'center_y': 0.39}
                canvas.before:
                    Color:
                        rgba: hex('#000000')
                    Rectangle:
                        pos: self.pos
                        size: self.size


<SearchViewMain>:
    OkerBox:
        orientation: 'vertical'
        id: search_view_main_container
        opacity: 1
        GreyLabel:
            id: search_typee
            size_hint_y: .09
            text: ''
        BoxLayout:
            id: search_view_main_container_holder
            padding: 5,5,5,5
            size_hint_y: .91


<SearchView>:
    name: 'search_view'
    on_enter: root.on_search_screen_enter()
    on_leave: root.clear_w()
    OkerBox:
        orientation: 'vertical'
        id: search_view_container
        opacity: 1
        BlackBox:
            id: search_view_holder


<ShowEpTor>:
    orientation: 'vertical'
    size_hint_y: None
    height: dp(180)

<ShowEpSingleTor>:
    orientation: 'vertical'
    GreyLabel:
        id: tor_quality_label
        size_hint_y: .2
        text:

    BoxLayout:
        orientation: 'horizontal'
        size_hint_y: .8
        BoxLayout:
            RelativeLayout:
                PlayButton:
                    id: tor_play
                    on_release: root.play_torrent()
        BoxLayout:
            RelativeLayout:
                DownloadButton:
                    id: tor_down
                    on_release: root.download_torrent()

<ShowEpSyn>:
    size_hint_y: None
    height: dp(150)
    TextInputYellow:
        id: show_episode_syn


<MainSingleTopLabel@Label>:
    color: hex('#ffa500')

<SeriesViewMainSingleTop>:
    orientation: 'horizontal'
    BoxLayout:
        orientation: 'horizontal'
        id: series_view_main_single_top_im_holder
        size_hint_x:.4
        AsyncImage:
            id: series_view_main_single_top_im_holder_IM
            source: ''
            allow_stretch: True
            keep_ratio: False
    BoxLayout:
        orientation: 'vertical'
        id: series_view_main_single_top_other
        size_hint_x:.6
        BoxLayout:
            size_hint_y: .1
            orientation: 'horizontal'
            MainSingleTopLabel:
                id: series_view_main_single_top_other_YE
                text:
            MainSingleTopLabel:
                id: series_view_main_single_top_other_RU
                text:
        MainSingleTopLabel:
            size_hint_y: .1
            id: series_view_main_single_top_other_ST
            text:
        BoxLayout:
            size_hint_y: .8
            ScrollView:
                id: scrlv
                TextInputYellow:
                    size_hint_y: None
                    id: series_view_main_single_top_other_DE
                    height: max(self.minimum_height, scrlv.height)


<SeriesViewMainSingle>:
    BlackBox:
        id: svmsingle
        orientation: 'vertical'
        GreyBox:
            orientation: 'horizontal'
            id: series_view_main_single_nav
            size_hint_y:.05
            BoxLayout:
                size_hint_x: .2
                FloatLayout:
                    SettingsViewButton:
                        width: dp(25)
                        height: dp(25)
                        background_down: "./images/back_icon.png"
                        background_normal: "./images/back_icon.png"
                        on_press : root.go_back_to_series()
            BoxLayout:
                id: series_view_main_single_nav_title
                size_hint_x: .6
                Label:
                    id: series_view_main_single_nav_title_t
                    text: ''
            BoxLayout:
                size_hint_x: .2
        BlackBox:
            orientation: 'vertical'
            size_hint_y: .45
            id: series_view_main_single_container
        BlackBox:
            orientation: 'vertical'
            size_hint_y: .5
            id: series_view_main_single_container_se


<SeriesViewMain>:
    OkerBox:
        orientation: 'vertical'
        id: series_view_main_container
        opacity: 1


<SeriesView>:
    name: 'series_view'
    OkerBox:
        orientation: 'vertical'
        id: series_view_container
        opacity: 1
        BlackBox:
            id: series_pag_holder
            size_hint_y: .09
        BlackBox:
            id: ser_view_holder
            size_hint_y: .91


<MoviesEpTor>:
    orientation: 'vertical'


<MoviesEpSingleTor>:
    orientation: 'vertical'
    GreyLabel:
        id: tor_quality_label
        size_hint_y: .2
        text:
    BoxLayout:
        orientation: 'horizontal'
        size_hint_y: .8
        BoxLayout:
            RelativeLayout:
                PlayButton:
                    id: tor_play
                    on_release: root.play_torrent()
        BoxLayout:
            RelativeLayout:
                DownloadButton:
                    id: tor_down
                    on_release: root.download_torrent()


<MoviesViewMainSingleTop>:
    orientation: 'horizontal'
    BoxLayout:
        orientation: 'horizontal'
        id: movies_view_main_single_top_im_holder
        size_hint_x:.4
        AsyncImage:
            id: movies_view_main_single_top_im_holder_IM
            source: ''
            allow_stretch: True
            keep_ratio: False
    BoxLayout:
        orientation: 'vertical'
        id: movies_view_main_single_top_other
        size_hint_x:.6
        BoxLayout:
            size_hint_y: .2
            orientation: 'horizontal'
            MainSingleTopLabel:
                id: movies_view_main_single_top_other_YE
                text:
            MainSingleTopLabel:
                id: movies_view_main_single_top_other_RU
                text:
        BoxLayout:
            size_hint_y: .8
            ScrollView:
                id: scrlv
                TextInputYellow:
                    size_hint_y: None
                    id: movies_view_main_single_top_other_DE
                    height: max(self.minimum_height, scrlv.height)


<MoviesViewMainSingle>:
    BlackBox:
        id: mvmsingle
        orientation: 'vertical'
        GreyBox:
            orientation: 'horizontal'
            id: movies_view_main_single_nav
            size_hint_y:.05
            BoxLayout:
                size_hint_x: .2
                FloatLayout:
                    SettingsViewButton:
                        width: dp(25)
                        height: dp(25)
                        background_down: "./images/back_icon.png"
                        background_normal: "./images/back_icon.png"
                        on_press : root.go_back_to_movies()
            BoxLayout:
                id: movies_view_main_single_nav_title
                size_hint_x: .6
                Label:
                    id: movies_view_main_single_nav_title_t
                    text: ''
            BoxLayout:
                size_hint_x: .2
        BlackBox:
            orientation: 'vertical'
            size_hint_y: .55
            id: movies_view_main_single_container
        BlackBox:
            orientation: 'vertical'
            size_hint_y: .40
            id: movies_view_main_single_container_se


<MoviesViewMain>:
    OkerBox:
        orientation: 'vertical'
        id: movies_view_main_container
        opacity: 1


<MoviesView>:
    name: 'movies_view'
    OkerBox:
        orientation: 'vertical'
        id: movies_view_container
        opacity: 1
        BlackBox:
            id: movies_pag_holder
            size_hint_y: .09
        BlackBox:
            id: mov_view_holder
            size_hint_y: .91


<LatestViewMain>:
    OkerBox:
        orientation: 'vertical'
        id: latest_view_main_container
        opacity: 1
        BoxLayout:
            id: latest_view_main_movies_container
            size_hint_y: .49
        BlackBox:
            size_hint_y: 0.02
            opacity: 1
        BoxLayout:
            id: latest_view_main_shows_container
            size_hint_y: .48


<LatestView>:
    name: 'latest_view'
    on_enter: root.refresh_on_enter()
    BlackBox:
        orientation: 'vertical'
        id: latest_view_container
        opacity: 1
        OkerBox:
            id: lat_view_holder
            size_hint_y: 1

<FavouritesViewMain>:
    OkerBox:
        orientation: 'vertical'
        id: favourites_view_main_container
        opacity: 1
        GreyLabel:
            id: search_typee
            size_hint_y: .09
            text: ''
        BoxLayout:
            id: favourites_view_main_container_holder
            padding: 5,5,5,5
            size_hint_y: .91


<FavouritesView>:
    name: 'favourites_view'
#    on_enter: root.refresh_on_enter()
    BlackBox:
        orientation: 'vertical'
        id: favourites_view_container
        opacity: 1
        OkerBox:
            id: fav_view_holder
            size_hint_y: 1


<Item>:
    id: ite
    orientation: 'vertical'
    size_hint:(None, None)
    canvas.before:
        Color:
            rgba: hex('#00000')
        Rectangle:
            pos: self.pos
            size: self.size
    BoxLayout:
        id: item_im_holder
        size_hint_y: .9
        FloatLayout:
            id: item_im_holder_float
            AsyncImage:
                id: item_im_holder_float_i
                pos_hint: {'center_x': 0.5, 'center_y': .5}
                no_cache: True
            Button:
                id: item_im_holder_float_b
                pos_hint: {'center_x': .85, 'center_y': .85}
                size_hint: (None,None)
                size:(dp(45),dp(45))
                background_normal: "./images/favno.png"
                background_down: "./images/fav.png"


    BoxLayout:
        id: item_title_b_holder
        size_hint_y: .1
        Button:
            id: item_title_b
            text: ''
            shorten_from:'right'
            halign: 'center'
            shorten: True
#            on_press: root.change_to_series_single(self._items.megs)

<ScanViewItem>:
    id: scan_view_i
    orientation: 'horizontal'
    size_hint_y: .4
    Label:
        id: scan_view_i_name
        size_hint_x: .8
        font_size: dp(16)
        padding: 15,15
        color: hex('#ffa500')
        text: ''
        font_hinting: 'mono'
    FancyCheckbox:
        id: scan_view_i_check
        group: 'address_setter'
        on_press: root.return_on_active_name(self.active, scan_view_i_name.text)


<FilterSpinner@Spinner>
    size_hint_x: None
    size_hint_y: None
    width: dp(200)
    height: dp(50)
    background_down: "./images/b_b.png"
    background_normal: "./images/filter_list_i.png"
    option_cls: Factory.TemplSpinnerOption
    text_autoupdate: True
    sync_height: True


<TemplSpinnerOption@SpinnerOption>
    background_down: "./images/b_b.png"
    background_normal: "./images/filter_list_i.png"


<FilterModalView>:
    auto_dismiss: True
    size_hint: (None, None)
    on_dismiss: root.close_filter(filter_type.text, filter_genre.text, filter_order.text, filter_sort.text)
    BoxLayout:
        id: filter_view_container
        orientation: 'vertical'
        RelativeLayout:
            FilterSpinner:
                id: filter_sort
                text: 'Sort'
                values: ['name','rating','trending','updated','year','last added', 'title', 'Sort']
                pos_hint: {'center_x': 0.5, 'center_y': 0.8}
                on_release: root.hide_other_accordions(self)
            FilterSpinner:
                id: filter_type
                text: 'Type'
                values: ['Shows', 'Movies','Type']
                pos_hint: {'center_x': 0.5, 'center_y': 0.4}
                on_release: root.hide_other_accordions(self)
            FilterSpinner:
                id: filter_order
                text: 'Order'
                values: ['-1','1','Order']
                pos_hint: {'center_x': 0.5, 'center_y': 0.6}
                on_release: root.hide_other_accordions(self)
            FilterSpinner:
                id: filter_genre
                text: 'Genre'
                values: ['action','adventure','animation','comedy','crime','documentary','drama','eastern','family','fan-film','fantasy','film-noir','history','horror','indie','mystery','none','romance','science-fiction','thriller','tv-movie','western', 'Genre']
                pos_hint: {'center_x': 0.5, 'center_y': 0.2}
                on_release: root.hide_other_accordions(self)


<ConnectionErrorPopup>:
    auto_dismiss: False
    size_hint: (None, None)
    separator_color: hex('#ffa500')
    title: 'Connection error'
    title_align: 'center'
    BlackBox:
        id: con_er_m
        orientation: 'vertical'
        Label:
            text: 'No connection to internet'
        SettingsViewButton:
            text: 'Retry'
            on_release: root.retry()
        SettingsViewButton:
            text: 'Quit'
            on_release: root.quit_app_cl()


<LoaderOverlay>:
    auto_dismiss: True
    size_hint: (None, None)
    background: './images/tb.png'
    BoxLayout:
        id: lo_container
        Image:
            allow_stretch: True
            source: './images/loa_over.png'


<PaginationButton>:
    size_hint_x: None
    size_hint_y: None
    width: dp(60)
    height: dp(50)
#    background_color:hex('#ffa500')
#
<MainNavButton>:
    size_hint_x: None
    size_hint_y: None
    width: dp(250)
    height: dp(45)
    background_down: "./images/n_b.png"
    background_normal: "./images/n_n.png"
    on_release: